<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Biof√≠sica UACH - Objeto 3 Interactivo</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:system-ui,-apple-system,sans-serif;background:#f3f4f6;color:#111827;line-height:1.5}
.container{max-width:1200px;margin:0 auto;padding:0 1rem}
.hidden{display:none !important}
.loading{position:fixed;inset:0;background:#f3f4f6;display:flex;align-items:center;justify-content:center;z-index:100;flex-direction:column;gap:1rem}
.spinner{width:40px;height:40px;border:4px solid #7f1d1d;border-top-color:transparent;border-radius:50%;animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.navbar{position:fixed;top:0;left:0;right:0;background:white;border-bottom:1px solid #e5e7eb;z-index:50;box-shadow:0 1px 3px rgba(0,0,0,0.1)}
.navbar-content{display:flex;justify-content:space-between;align-items:center;height:4rem;padding:0 1rem}
.brand{display:flex;align-items:center;gap:0.75rem}
.brand-icon{width:2.5rem;height:2.5rem;background:#7f1d1d;color:white;border-radius:0.5rem;display:flex;align-items:center;justify-content:center;font-size:1.25rem}
.brand-text h1{font-size:0.875rem;font-weight:700;color:#111827}
.brand-text p{font-size:0.75rem;color:#6b7280}
.stats{display:flex;gap:1rem;align-items:center}
.stat-item{text-align:center;padding:0.5rem;background:#f9fafb;border-radius:0.5rem;min-width:4rem}
.stat-value{font-size:1.25rem;font-weight:700;color:#7f1d1d}
.stat-label{font-size:0.625rem;color:#6b7280;text-transform:uppercase}
.progress{width:8rem}
.progress-bar{height:0.5rem;background:#e5e7eb;border-radius:9999px;overflow:hidden;margin-top:0.25rem}
.progress-fill{height:100%;background:#7f1d1d;transition:width 0.3s;width:0%}
main{padding-top:5rem;padding-bottom:3rem}
.hero{background:linear-gradient(135deg,#7f1d1d,#991b1b);color:white;padding:2rem;border-radius:1rem;margin-bottom:2rem;position:relative;overflow:hidden}
.hero::before{content:'';position:absolute;top:-50%;right:-10%;width:300px;height:300px;background:rgba(255,255,255,0.1);border-radius:50%;z-index:0}
.hero-content{position:relative;z-index:1}
.hero h2{font-size:1.875rem;font-weight:700;margin-bottom:0.5rem}
.hero p{color:#fecaca;margin-bottom:1.5rem}
.btn{display:inline-flex;align-items:center;gap:0.5rem;padding:0.625rem 1.25rem;border-radius:0.5rem;font-weight:500;cursor:pointer;border:none;font-size:0.875rem;transition:all 0.2s}
.btn-white{background:white;color:#7f1d1d}
.btn-white:hover{background:#f9fafb;transform:translateY(-1px)}
.btn-outline{background:rgba(255,255,255,0.1);color:white;border:1px solid rgba(255,255,255,0.3)}
.btn-outline:hover{background:rgba(255,255,255,0.2)}
.tabs{display:flex;gap:0.5rem;margin-bottom:2rem;background:white;padding:0.5rem;border-radius:0.75rem;box-shadow:0 1px 3px rgba(0,0,0,0.1);overflow-x:auto}
.tab{padding:0.625rem 1rem;border-radius:0.5rem;cursor:pointer;white-space:nowrap;font-size:0.875rem;font-weight:500;color:#6b7280;transition:all 0.2s}
.tab:hover{background:#f3f4f6}
.tab.active{background:#7f1d1d;color:white}
.card{background:white;border-radius:0.75rem;box-shadow:0 1px 3px rgba(0,0,0,0.1);border:1px solid #e5e7eb;margin-bottom:1.5rem;overflow:hidden}
.card-header{padding:1rem 1.5rem;border-bottom:1px solid #e5e7eb;background:#f9fafb;font-weight:700;display:flex;align-items:center;gap:0.5rem}
.quiz-container{padding:1.5rem}
.quiz-question{margin-bottom:2rem}
.quiz-q{font-weight:600;margin-bottom:1rem;font-size:1rem}
.quiz-options{display:flex;flex-direction:column;gap:0.75rem}
.quiz-option{padding:1rem;border:2px solid #e5e7eb;border-radius:0.5rem;cursor:pointer;transition:all 0.2s;background:white}
.quiz-option:hover{border-color:#7f1d1d;background:#fef2f2}
.quiz-option.selected{border-color:#7f1d1d;background:#fee2e2}
.quiz-option.correct{border-color:#22c55e;background:#f0fdf4}
.quiz-option.incorrect{border-color:#ef4444;background:#fef2f2}
.quiz-feedback{margin-top:1rem;padding:1rem;border-radius:0.5rem;font-size:0.875rem}
.quiz-feedback.correct{background:#f0fdf4;border:1px solid #86efac;color:#166534}
.quiz-feedback.incorrect{background:#fef2f2;border:1px solid #fca5a5;color:#991b1b}
.drag-drop-zone{padding:1.5rem}
.drop-zones{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1rem;margin-bottom:1.5rem}
.drop-zone{min-height:200px;padding:1rem;border:2px dashed #d1d5db;border-radius:0.75rem;background:#fafafa}
.drop-zone-title{font-weight:700;margin-bottom:0.75rem;color:#374151;text-align:center;padding-bottom:0.5rem;border-bottom:2px solid #e5e7eb}
.drop-zone.over{border-color:#7f1d1d;background:#fef2f2}
.draggables{display:flex;flex-wrap:wrap;gap:0.75rem;padding:1rem;background:#f9fafb;border-radius:0.5rem;margin-bottom:1rem}
.draggable{padding:0.75rem 1rem;background:white;border:2px solid #d1d5db;border-radius:0.5rem;cursor:move;font-size:0.875rem;font-weight:500;transition:all 0.2s}
.draggable:hover{border-color:#7f1d1d;transform:scale(1.05)}
.draggable.dragging{opacity:0.5}
.draggable.placed{background:#f0fdf4;border-color:#86efac}
.simulator{padding:1.5rem}
.sim-controls{display:flex;gap:1rem;margin-bottom:1.5rem;flex-wrap:wrap}
.sim-canvas{min-height:300px;border:2px solid #e5e7eb;border-radius:0.75rem;background:white;position:relative;overflow:hidden}
.molecule{position:absolute;width:30px;height:30px;border-radius:50%;transition:all 0.3s}
.saturated{background:#15803d}
.cis{background:#2563eb}
.trans{background:#c2410c}
.water{position:absolute;width:20px;height:20px;background:rgba(59,130,246,0.3);border-radius:50%}
.bilayer{position:absolute;width:100%;height:60%;top:20%;background:linear-gradient(to bottom,#fef3c2 0%,#fef3c2 20%,transparent 20%,transparent 80%,#fef3c2 80%,#fef3c2 100%)}
.calculator{padding:1.5rem}
.calc-input{display:flex;flex-direction:column;gap:1rem;margin-bottom:1rem}
.calc-input label{font-weight:600;font-size:0.875rem}
.calc-input input,.calc-input select{padding:0.75rem;border:1px solid #d1d5db;border-radius:0.5rem;font-size:0.875rem}
.calc-result{padding:1.5rem;background:#eff6ff;border:1px solid #bfdbfe;border-radius:0.75rem;margin-top:1rem}
.calc-result-value{font-size:1.5rem;font-weight:700;color:#1e40af;margin-bottom:0.5rem}
.badge{display:inline-flex;align-items:center;justify-content:center;width:60px;height:60px;background:#f3f4f6;border-radius:50%;font-size:1.5rem;margin:0.5rem}
.badge.earned{background:linear-gradient(135deg,#fbbf24,#f59e0b);animation:pulse 2s infinite}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}
.achievement-bar{padding:1rem;background:white;border-radius:0.75rem;margin-bottom:1rem}
.achievement-list{display:flex;gap:0.5rem;flex-wrap:wrap;margin-top:0.5rem}
.achievement{padding:0.5rem 1rem;background:#f3f4f6;border-radius:0.5rem;font-size:0.75rem;display:flex;align-items:center;gap:0.5rem}
.achievement.unlocked{background:#fef3c7;border:1px solid #fcd34d}
.question-list{padding:1.5rem}
.question-item{margin-bottom:1.5rem;padding-left:1rem;border-left:4px solid #fbbf24;transition:all 0.3s}
.question-item.completed{border-left-color:#22c55e;background:#f0fdf4;padding:1rem;border-radius:0 0.5rem 0.5rem 0}
.question-text{font-weight:600;margin-bottom:0.5rem;display:block}
textarea{width:100%;padding:0.75rem;border:1px solid #d1d5db;border-radius:0.5rem;font-family:inherit;font-size:0.875rem;resize:vertical;min-height:100px}
textarea:focus{outline:none;border-color:#7f1d1d;box-shadow:0 0 0 3px rgba(127,29,29,0.1)}
.flashcard-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1rem;margin:2rem 0}
.flashcard{background:white;border:1px solid #e5e7eb;border-radius:0.75rem;padding:1.5rem;text-align:center;cursor:pointer;transition:transform 0.2s;box-shadow:0 1px 3px rgba(0,0,0,0.1);min-height:200px;display:flex;align-items:center;justify-content:center;flex-direction:column}
.flashcard:hover{transform:translateY(-2px);box-shadow:0 4px 6px rgba(0,0,0,0.1)}
.flashcard-front{font-weight:700;color:#111827;margin-bottom:0.5rem}
.flashcard-back{display:none;color:#4b5563;font-size:0.875rem;padding-top:1rem;border-top:1px solid #e5e7eb;margin-top:1rem}
.flashcard.flipped .flashcard-front{display:none}
.flashcard.flipped .flashcard-back{display:block}
.integradora{background:linear-gradient(to right,#fef3c7,#fffbeb);border:2px solid #fcd34d}
.integradora-header{background:#fef3c7}
footer{text-align:center;padding:2rem;color:#9ca3af;font-size:0.875rem;margin-top:3rem}
.alert{padding:1rem;border-radius:0.5rem;margin-bottom:1rem;border:1px solid}
.alert-info{background:#eff6ff;border-color:#bfdbfe;color:#1e40af}
.alert-success{background:#f0fdf4;border-color:#86efac;color:#166534}
.alert-warning{background:#fffbeb;border-color:#fcd34d;color:#92400e}
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:100;align-items:center;justify-content:center}
.modal.show{display:flex}
.modal-content{background:white;border-radius:1rem;padding:2rem;max-width:500px;margin:1rem;box-shadow:0 20px 25px -5px rgba(0,0,0,0.3)}
.modal-header{font-size:1.25rem;font-weight:700;margin-bottom:1rem}
.modal-body{margin-bottom:1.5rem}
.modal-footer{display:flex;gap:0.5rem;justify-content:flex-end}
.btn-primary{background:#7f1d1d;color:white;border-color:#7f1d1d}
.btn-primary:hover{background:#991b1b}
.btn-secondary{background:#f3f4f6;color:#374151;border:1px solid #d1d5db}
.btn-secondary:hover{background:#e5e7eb}
@media (max-width: 768px){
.stats{display:none}
.tabs{padding:0.25rem}
.tab{padding:0.5rem 0.75rem;font-size:0.75rem}
}
</style>
</head>
<body>

<div id="loading" class="loading">
<div class="spinner"></div>
<p style="font-weight:600">Iniciando Biof√≠sica Interactiva...</p>
</div>

<div id="app" class="hidden">
<nav class="navbar">
<div class="navbar-content">
<div class="brand">
<div class="brand-icon">üß¨</div>
<div class="brand-text">
<h1>Biof√≠sica UACH</h1>
<p>Objeto 3: L√≠pidos y Membranas</p>
</div>
</div>
<div class="stats">
<div class="stat-item">
<div class="stat-value" id="stat-points">0</div>
<div class="stat-label">Puntos</div>
</div>
<div class="stat-item">
<div class="stat-value" id="stat-badges">0/10</div>
<div class="stat-label">Logros</div>
</div>
<div class="progress">
<div style="font-size:0.75rem;color:#6b7280">Progreso</div>
<div class="progress-bar"><div id="progress-fill" class="progress-fill"></div></div>
</div>
</div>
<button onclick="exportar()" style="padding:0.5rem;background:#f3f4f6;border:1px solid #d1d5db;border-radius:0.375rem;cursor:pointer" title="Exportar">üíæ</button>
</div>
</nav>

<main class="container">
<div class="hero">
<div class="hero-content">
<h2>üéØ L√≠pidos y Membranas - Modo Interactivo</h2>
<p>Aprende mediante quizzes, simulaciones y actividades gamificadas</p>
<div style="display:flex;gap:0.5rem;flex-wrap:wrap">
<button class="btn btn-white" onclick="showTab('quizzes')">üìù Quizzes</button>
<button class="btn btn-outline" onclick="showTab('drag-drop')">üéØ Clasificar</button>
<button class="btn btn-outline" onclick="showTab('simulator')">üß™ Simulador</button>
<button class="btn btn-outline" onclick="showTab('ejercicios')">‚úçÔ∏è Ejercicios</button>
</div>
</div>
</div>

<div class="achievement-bar">
<div style="font-weight:700;margin-bottom:0.5rem">üèÜ Tus Logros</div>
<div class="achievement-list">
<div class="achievement" id="ach-1"><span>üéì</span> Primera pregunta</div>
<div class="achievement" id="ach-2"><span>üìö</span> 10 completadas</div>
<div class="achievement" id="ach-3"><span>‚ö°</span> Quiz perfecto</div>
<div class="achievement" id="ach-4"><span>üéØ</span> Clasificaci√≥n</div>
<div class="achievement" id="ach-5"><span>üß™</span> Simulador</div>
<div class="achievement" id="ach-6"><span>üíØ</span> 50% progreso</div>
<div class="achievement" id="ach-7"><span>üî¨</span> Todas desarrollo</div>
<div class="achievement" id="ach-8"><span>üöÄ</span> Todas aplicaci√≥n</div>
<div class="achievement" id="ach-9"><span>üëë</span> 100% completo</div>
<div class="achievement" id="ach-10"><span>‚≠ê</span> Maestro l√≠pidos</div>
</div>
</div>

<div class="tabs">
<div class="tab active" onclick="showTab('quizzes')">üìù Quizzes Interactivos</div>
<div class="tab" onclick="showTab('drag-drop')">üéØ Clasificar L√≠pidos</div>
<div class="tab" onclick="showTab('simulator')">üß™ Simulador Membranas</div>
<div class="tab" onclick="showTab('calculator')">üî¢ Calculadora</div>
<div class="tab" onclick="showTab('flashcards')">üé¥ Flashcards</div>
<div class="tab" onclick="showTab('ejercicios')">‚úçÔ∏è Ejercicios Escritos</div>
</div>

<!-- QUIZZES -->
<div id="tab-quizzes" class="tab-content">
<div class="card">
<div class="card-header" style="background:#eff6ff;color:#1e40af">
üìù Quizzes de Autoevaluaci√≥n
</div>
<div class="quiz-container" id="quiz-container"></div>
</div>
</div>

<!-- DRAG & DROP -->
<div id="tab-drag-drop" class="tab-content hidden">
<div class="card">
<div class="card-header" style="background:#f0fdf4;color:#166534">
üéØ Clasifica los L√≠pidos por Categor√≠a
</div>
<div class="drag-drop-zone">
<div class="alert alert-info">
<strong>Instrucciones:</strong> Arrastra cada l√≠pido a su categor√≠a correspondiente. Ganar√°s puntos por cada respuesta correcta.
</div>
<div class="draggables" id="draggables-lipids"></div>
<div class="drop-zones">
<div class="drop-zone" data-category="saturados">
<div class="drop-zone-title">√Åcidos Grasos Saturados</div>
<div class="drop-items" id="drop-saturados"></div>
</div>
<div class="drop-zone" data-category="insaturados">
<div class="drop-zone-title">√Åcidos Grasos Insaturados</div>
<div class="drop-items" id="drop-insaturados"></div>
</div>
<div class="drop-zone" data-category="fosfolipidos">
<div class="drop-zone-title">Fosfol√≠pidos</div>
<div class="drop-items" id="drop-fosfolipidos"></div>
</div>
<div class="drop-zone" data-category="esteroides">
<div class="drop-zone-title">Esteroides</div>
<div class="drop-items" id="drop-esteroides"></div>
</div>
</div>
<button class="btn btn-primary" onclick="checkDragDrop()" style="margin-top:1rem">Verificar Respuestas</button>
<button class="btn btn-secondary" onclick="resetDragDrop()" style="margin-top:1rem">Reiniciar</button>
</div>
</div>
</div>

<!-- SIMULATOR -->
<div id="tab-simulator" class="tab-content hidden">
<div class="card">
<div class="card-header" style="background:#fffbeb;color:#92400e">
üß™ Simulador de Formaci√≥n de Bicapa Lip√≠dica
</div>
<div class="simulator">
<div class="alert alert-info">
<strong>Simulador:</strong> Observa c√≥mo los fosfol√≠pidos se auto-ensamblan en una bicapa cuando se encuentran en medio acuoso. Los c√≠rculos representan las cabezas hidrof√≠licas y las colas las cadenas hidrof√≥bicas.
</div>
<div class="sim-controls">
<button class="btn btn-primary" onclick="startSimulation()">‚ñ∂Ô∏è Iniciar</button>
<button class="btn btn-secondary" onclick="pauseSimulation()">‚è∏Ô∏è Pausar</button>
<button class="btn btn-secondary" onclick="resetSimulation()">üîÑ Reiniciar</button>
<select id="sim-lipid-type" style="padding:0.625rem;border:1px solid #d1d5db;border-radius:0.5rem">
<option value="saturated">Saturados (r√≠gidos)</option>
<option value="unsaturated">Insaturados (flexibles)</option>
<option value="mixed">Mixto</option>
</select>
</div>
<div class="sim-canvas" id="sim-canvas"></div>
<div style="margin-top:1rem;padding:1rem;background:#f9fafb;border-radius:0.5rem">
<strong>üìä Estad√≠sticas:</strong>
<div>Fosfol√≠pidos: <span id="sim-stat-lipids">0</span></div>
<div>Formando bicapa: <span id="sim-stat-bilayer">0%</span></div>
<div>Fluidez: <span id="sim-stat-fluidity">Media</span></div>
</div>
</div>
</div>
</div>

<!-- CALCULATOR -->
<div id="tab-calculator" class="tab-content hidden">
<div class="card">
<div class="card-header" style="background:#faf5ff;color:#7c3aed">
üî¢ Calculadora de √çndice de Yodo
</div>
<div class="calculator">
<div class="alert alert-info">
<strong>√çndice de Yodo:</strong> Mide el grado de insaturaci√≥n de una grasa. Mayor √≠ndice = m√°s dobles enlaces.
</div>
<div class="calc-input">
<label>Selecciona el √°cido graso:</label>
<select id="calc-fatty-acid" onchange="calculateIodine()">
<option value="">-- Selecciona --</option>
<option value="0">√Åcido Este√°rico (18:0) - Saturado</option>
<option value="90">√Åcido Oleico (18:1) - Monoinsaturado</option>
<option value="181">√Åcido Linol√©ico (18:2) - Poliinsaturado</option>
<option value="274">√Åcido Linol√©nico (18:3) - Poliinsaturado</option>
<option value="337">√Åcido Araquid√≥nico (20:4) - Poliinsaturado</option>
</select>
</div>
<div class="calc-result" id="calc-result" style="display:none">
<div class="calc-result-value" id="calc-value">--</div>
<div id="calc-interpretation"></div>
</div>
</div>
</div>

<div class="card">
<div class="card-header" style="background:#ecfdf5;color:#065f46">
üìê Estimador de Punto de Fusi√≥n
</div>
<div class="calculator">
<div class="calc-input">
<label>Longitud de cadena (√°tomos de C):</label>
<input type="number" id="calc-chain-length" min="4" max="24" value="18" oninput="calculateMeltingPoint()">
<label>N√∫mero de dobles enlaces:</label>
<input type="number" id="calc-double-bonds" min="0" max="6" value="0" oninput="calculateMeltingPoint()">
<label>Configuraci√≥n:</label>
<select id="calc-config" onchange="calculateMeltingPoint()">
<option value="none">Sin dobles enlaces</option>
<option value="cis">Cis</option>
<option value="trans">Trans</option>
</select>
</div>
<div class="calc-result" id="calc-mp-result" style="display:none">
<div class="calc-result-value" id="calc-mp-value">--</div>
<div id="calc-mp-interpretation"></div>
</div>
</div>
</div>
</div>

<!-- FLASHCARDS -->
<div id="tab-flashcards" class="tab-content hidden">
<div class="card">
<div class="card-header" style="background:#fef2f2;color:#991b1b">
üé¥ Tarjetas de Estudio - Haz clic para voltear
</div>
<div style="padding:1.5rem">
<div class="flashcard-grid" id="flashcard-container"></div>
</div>
</div>
</div>

<!-- EJERCICIOS -->
<div id="tab-ejercicios" class="tab-content hidden">
<div id="preguntas-container"></div>
</div>

<footer>
<p>Biof√≠sica UACH - Objeto de Estudio 3 - Versi√≥n Interactiva</p>
<p style="font-size:0.75rem;margin-top:0.5rem">Prof. Daniel - Universidad Aut√≥noma de Chihuahua</p>
<p id="last-save" style="font-size:0.75rem;margin-top:0.25rem;color:#9ca3af">-</p>
</footer>
</main>
</div>

<div id="achievement-modal" class="modal">
<div class="modal-content">
<div class="modal-header">üéâ ¬°Logro Desbloqueado!</div>
<div class="modal-body">
<div style="text-align:center;font-size:4rem;margin:1rem 0" id="modal-badge"></div>
<div style="text-align:center;font-weight:600;font-size:1.125rem" id="modal-title"></div>
<div style="text-align:center;color:#6b7280;margin-top:0.5rem" id="modal-description"></div>
<div style="text-align:center;margin-top:1rem">
<span style="font-size:1.5rem;color:#7f1d1d">+<span id="modal-points"></span> puntos</span>
</div>
</div>
<div class="modal-footer">
<button class="btn btn-primary" onclick="closeAchievementModal()">¬°Genial!</button>
</div>
</div>
</div>

<script>
// ============================================
// VARIABLES GLOBALES
// ============================================
var respuestas = {};
var userStats = {
points: 0,
badges: 0,
achievements: {},
quizzesCompleted: 0,
perfectQuizzes: 0
};

var currentTab = 'quizzes';
var simInterval = null;
var simRunning = false;
var simLipids = [];

// Datos de preguntas (mismo formato anterior)
var preguntasData = {
pre:["¬øQu√© caracter√≠sticas comunes tienen aceite, mantequilla y colesterol?","Mencione 3 funciones de l√≠pidos.","Diferencia entre grasas s√≥lidas y l√≠quidas.","¬øQu√© sabe de saturadas vs insaturadas?","¬øQu√© l√≠pidos forman membranas y por qu√©?","¬øQu√© son vitaminas liposolubles?","¬øPor qu√© las grasas son energ√≠a concentrada?","¬øQu√© es el colesterol?","¬øC√≥mo se digieren las grasas en sangre acuosa?","¬øD√≥nde se encuentran omega-3 y omega-6?"],
sec31:{titulo:"3.1 Introducci√≥n",dev:["Defina l√≠pidos por solubilidad.","Enumere funciones de l√≠pidos.","¬øPor qu√© son eficientes para energ√≠a vs gluc√≥geno?","Clasifique l√≠pidos en 6 categor√≠as."],app:["Funci√≥n de aislamiento t√©rmico.","L√≠pidos en secreciones de aves acu√°ticas.","Implicaciones dieta baja en grasas."]},
sec32:{titulo:"3.2 √Åcidos Grasos",dev:["Estructura general (alfa, beta, omega).","Diferencia saturado vs insaturado.","Efecto del doble enlace cis.","Relaci√≥n saturaci√≥n-punto fusi√≥n.","Defina mono y poliinsaturado.","√Åcidos grasos esenciales.","Nomenclatura omega."],app:["Diferencia este√°rico vs oleico.","Hidrogenaci√≥n parcial y subproductos.","Ordene por punto fusi√≥n.","¬øAraquid√≥nico: omega-3 o 6?"]},
sec33:{titulo:"3.3 TAGs y Ceras",dev:["Estructura TAG.","¬øPor qu√© son hidrof√≥bicos?","C√©lulas de almacenamiento.","Diferencia grasa vs aceite.","Saponificaci√≥n.","Composici√≥n de ceras.","Funci√≥n de ceras."],app:["Composici√≥n: aceite ma√≠z vs grasa res.","Jab√≥n como emulsionante.","Impermeabilidad de ceras."]},
sec34:{titulo:"3.4 Fosfol√≠pidos",dev:["Naturaleza anfip√°tica.","¬øPor qu√© forman bicapa?","Dos clases principales.","Precursor fosfoglic√©rido.","4 alcoholes del fosfato.","Cardiolipina.","DPPC en surfactante pulmonar."],app:["Saturaci√≥n y fluidez.","Fosfolipasa C y PIP2.","Fosfatidilserina en apoptosis.","PLA2 en veneno de serpiente."]},
sec35:{titulo:"3.5 Esfingol√≠pidos",dev:["Mol√©cula base.","Defina ceramida.","¬øD√≥nde hay esfingomielina?","Glicoesfingol√≠pidos.","Cerebr√≥sidos vs gangli√≥sidos.","Enzima deficiente en Tay-Sachs."],app:["Aislante el√©ctrico.","Toxina del c√≥lera y GM1.","Organulo en Gaucher.","Esqueletos: fosfatidilcolina vs esfingomielina."]},
sec36:{titulo:"3.6 Isoprenoides",dev:["Unidad estructural.","Terpenos vs esteroides.","Clasificaci√≥n de terpenos.","Terpenoides mixtos.","N√∫cleo esteroideo.","S√≠ntesis desde colesterol.","Hormonas esteroideas."],app:["Beta-caroteno a vit A.","Colesterol y fluidez.","Colesterol vs √°cido c√≥lico.","Gluc√≥sidos card√≠acos."]},
sec37:{titulo:"3.7 Eicosanoides",dev:["Precursor.","3 clases.","Liberaci√≥n de membrana (enzima).","Comparaci√≥n con hormonas.","Reacci√≥n COX.","Funciones fisiol√≥gicas."],app:["Aspirina e inhibici√≥n COX.","Inhibidores COX-2 selectivos.","Balance TXA2 vs PGI2.","Corticosteroides vs aspirina."]},
sec38:{titulo:"3.8 Digesti√≥n",dev:["Desaf√≠os en medio acuoso.","Sales biliares.","Lipasa pancre√°tica.","Absorci√≥n en mucosa.","Quilomicrones.","Lipoprote√≠na lipasa."],app:["Obstrucci√≥n biliar y esteatorrea.","Olestra sin calor√≠as.","Fibra soluble y colesterol.","Hiperquilomicronemia familiar."]}
};

// Quizzes interactivos
var quizzes = [
{
q: "¬øCu√°l es la principal diferencia entre un √°cido graso saturado y uno insaturado?",
opts: [
"El saturado tiene dobles enlaces, el insaturado no",
"El saturado NO tiene dobles enlaces, el insaturado S√ç",
"Ambos tienen dobles enlaces",
"La diferencia est√° en el n√∫mero de carbonos"
],
correct: 1,
explanation: "Los √°cidos grasos SATURADOS no tienen dobles enlaces C=C (saturados de hidr√≥geno), mientras que los INSATURADOS tienen uno o m√°s dobles enlaces."
},
{
q: "¬øQu√© efecto tiene un doble enlace CIS en la cadena de √°cidos grasos?",
opts: [
"Hace la cadena completamente recta",
"Introduce una curvatura de ~30 grados",
"No afecta la forma de la cadena",
"Aumenta el punto de fusi√≥n"
],
correct: 1,
explanation: "El doble enlace CIS introduce una curvatura de aproximadamente 30¬∞ porque los hidr√≥genos est√°n del mismo lado, creando una torcedura que impide el empaquetamiento ordenado."
},
{
q: "¬øPor qu√© los fosfol√≠pidos forman espont√°neamente bicapas en agua?",
opts: [
"Porque son completamente hidrof√≠licos",
"Porque son anfip√°ticos: tienen cabeza hidrof√≠lica y colas hidrof√≥bicas",
"Porque son completamente hidrof√≥bicos",
"Por su tama√±o molecular"
],
correct: 1,
explanation: "Los fosfol√≠pidos son ANFIP√ÅTICOS: tienen una cabeza polar (hidrof√≠lica) que interact√∫a con el agua y colas apolares (hidrof√≥bicas) que la evitan. En agua, se auto-organizan en bicapa para minimizar el contacto de las colas con el agua."
},
{
q: "¬øCu√°l es el precursor de los eicosanoides?",
opts: [
"√Åcido oleico",
"√Åcido araquid√≥nico",
"Colesterol",
"Glucosa"
],
correct: 1,
explanation: "El √°cido ARAQUID√ìNICO (20:4) es el principal precursor de los eicosanoides (prostaglandinas, tromboxanos, leucotrienos). Se libera de los fosfol√≠pidos de membrana por la fosfolipasa A2."
},
{
q: "¬øQu√© enzima inhibe la aspirina para producir su efecto antiinflamatorio?",
opts: [
"Lipasa",
"Fosfolipasa A2",
"Ciclooxigenasa (COX)",
"Lipoprote√≠na lipasa"
],
correct: 2,
explanation: "La aspirina inhibe la enzima CICLOOXIGENASA (COX), que convierte el √°cido araquid√≥nico en prostaglandinas y tromboxanos, reduciendo as√≠ la inflamaci√≥n y el dolor."
},
{
q: "¬øQu√© estructura forma la esfingomielina en las neuronas?",
opts: [
"Membrana plasm√°tica",
"Vaina de mielina",
"N√∫cleo celular",
"Citoplasma"
],
correct: 1,
explanation: "La esfingomielina es un componente principal de la VAINA DE MIELINA que a√≠sla los axones neuronales, permitiendo la conducci√≥n saltatoria r√°pida de los impulsos nerviosos."
},
{
q: "¬øQu√© lipoprote√≠na transporta l√≠pidos desde el intestino despu√©s de una comida?",
opts: [
"LDL",
"HDL",
"Quilomicrones",
"VLDL"
],
correct: 2,
explanation: "Los QUILOMICRONES son lipoprote√≠nas grandes que transportan los triglic√©ridos y otros l√≠pidos absorbidos desde el intestino hacia la circulaci√≥n linf√°tica y sangu√≠nea."
},
{
q: "El √°cido araquid√≥nico 20:4(œâ-6) es un √°cido graso:",
opts: [
"Omega-3",
"Omega-6",
"Omega-9",
"Saturado"
],
correct: 1,
explanation: "El √°cido araquid√≥nico es OMEGA-6 (œâ-6), lo que significa que el primer doble enlace desde el extremo metilo est√° en el carbono 6. Es un √°cido graso esencial precursor de eicosanoides."
}
];

// L√≠pidos para drag & drop
var lipidsData = [
{name: "√Åcido Este√°rico (18:0)", category: "saturados"},
{name: "√Åcido Palm√≠tico (16:0)", category: "saturados"},
{name: "√Åcido Oleico (18:1 cis)", category: "insaturados"},
{name: "√Åcido Linol√©ico (18:2)", category: "insaturados"},
{name: "Fosfatidilcolina", category: "fosfolipidos"},
{name: "Fosfatidilserina", category: "fosfolipidos"},
{name: "Esfingomielina", category: "fosfolipidos"},
{name: "Colesterol", category: "esteroides"},
{name: "Testosterona", category: "esteroides"},
{name: "Cortisol", category: "esteroides"}
];

// Flashcards
var flashcardsData = [
{front: "¬øQu√© son los l√≠pidos?", back: "Mol√©culas biol√≥gicas insolubles en agua pero solubles en solventes org√°nicos (cloroformo, √©ter). Incluyen grasas, aceites, fosfol√≠pidos, esteroides y ceras."},
{front: "Diferencia cis vs trans", back: "CIS: hidr√≥genos del mismo lado del doble enlace ‚Üí curvatura molecular. TRANS: hidr√≥genos en lados opuestos ‚Üí cadena recta."},
{front: "¬øQu√© es un fosfol√≠pido?", back: "L√≠pido anfip√°tico con glicerol, 2 √°cidos grasos, grupo fosfato y un alcohol. Forma bicapas en membranas celulares."},
{front: "Funci√≥n del colesterol", back: "Componente de membranas que regula fluidez, precursor de hormonas esteroideas, √°cidos biliares y vitamina D."},
{front: "¬øQu√© son eicosanoides?", back: "Mol√©culas se√±alizadoras derivadas del √°cido araquid√≥nico: prostaglandinas, tromboxanos y leucotrienos. Median inflamaci√≥n y homeostasis."},
{front: "Saponificaci√≥n", back: "Hidr√≥lisis de triglic√©ridos con base fuerte (NaOH) para producir glicerol y sales de √°cidos grasos (jab√≥n)."},
{front: "Omega-3 vs Omega-6", back: "Omega-3: primer doble enlace en C3 (EPA, DHA). Omega-6: primer doble enlace en C6 (√°cido linoleico, araquid√≥nico). Ambos esenciales."},
{front: "¬øQu√© es la vaina de mielina?", back: "Envoltura rica en esfingomielina y cerebr√≥sidos que a√≠sla axones neuronales permitiendo conducci√≥n saltatoria r√°pida."},
{front: "Funci√≥n de las sales biliares", back: "Emulsifican grasas en el intestino, aumentando la superficie para acci√≥n de lipasas pancre√°ticas."},
{front: "LDL vs HDL", back: "LDL: transporta colesterol a tejidos (\"malo\" si se acumula). HDL: recoge colesterol de tejidos al h√≠gado (\"bueno\" - protector)."}
];

// Logros
var achievements = {
1: {icon: "üéì", title: "Primer Paso", desc: "Completaste tu primera pregunta", points: 10},
2: {icon: "üìö", title: "Estudiante Dedicado", desc: "10 preguntas completadas", points: 50},
3: {icon: "‚ö°", title: "Quiz Perfecto", desc: "Quiz sin errores", points: 100},
4: {icon: "üéØ", title: "Clasificador Experto", desc: "Completaste clasificaci√≥n l√≠pidos", points: 75},
5: {icon: "üß™", title: "Cient√≠fico", desc: "Usaste el simulador", points: 50},
6: {icon: "üíØ", title: "Medio Camino", desc: "50% de progreso", points: 150},
7: {icon: "üî¨", title: "Desarrollo Master", desc: "Todas las de desarrollo", points: 200},
8: {icon: "üöÄ", title: "Aplicaci√≥n Pro", desc: "Todas las de aplicaci√≥n", points: 200},
9: {icon: "üëë", title: "Completado 100%", desc: "Todas las actividades", points: 500},
10: {icon: "‚≠ê", title: "Maestro de L√≠pidos", desc: "Dominaste el tema", points: 1000}
};

// ============================================
// INICIALIZACI√ìN
// ============================================
function init() {
loadData();
renderQuizzes();
renderDragDrop();
renderFlashcards();
renderPreguntas();
updateStats();
showTab('quizzes');
setTimeout(function() {
document.getElementById('loading').classList.add('hidden');
document.getElementById('app').classList.remove('hidden');
}, 300);
}

function loadData() {
try {
var saved = localStorage.getItem('bio_uach_obj3');
if(saved) respuestas = JSON.parse(saved);
var stats = localStorage.getItem('bio_stats');
if(stats) userStats = JSON.parse(stats);
} catch(e) {
console.error('Error cargando:', e);
}
}

function saveData() {
try {
localStorage.setItem('bio_uach_obj3', JSON.stringify(respuestas));
localStorage.setItem('bio_stats', JSON.stringify(userStats));
} catch(e) {
console.error('Error guardando:', e);
}
}

// ============================================
// NAVEGACI√ìN TABS
// ============================================
function showTab(tab) {
currentTab = tab;
var tabs = document.querySelectorAll('.tab');
tabs.forEach(function(t) { t.classList.remove('active'); });
var contents = document.querySelectorAll('.tab-content');
contents.forEach(function(c) { c.classList.add('hidden'); });
document.querySelector('[onclick="showTab(\''+tab+'\')"]').classList.add('active');
document.getElementById('tab-'+tab).classList.remove('hidden');
}

// ============================================
// QUIZZES
// ============================================
function renderQuizzes() {
var html = '<div class="alert alert-info"><strong>üìù Instrucciones:</strong> Responde cada pregunta y recibe retroalimentaci√≥n inmediata. ¬°Ganar√°s puntos por cada respuesta correcta!</div>';
quizzes.forEach(function(quiz, idx) {
html += '<div class="quiz-question" id="quiz-'+idx+'">';
html += '<div class="quiz-q">'+(idx+1)+'. '+quiz.q+'</div>';
html += '<div class="quiz-options">';
quiz.opts.forEach(function(opt, oidx) {
html += '<div class="quiz-option" onclick="selectQuizOption('+idx+','+oidx+')">'+opt+'</div>';
});
html += '</div>';
html += '<div id="quiz-feedback-'+idx+'"></div>';
html += '</div>';
});
document.getElementById('quiz-container').innerHTML = html;
}

function selectQuizOption(qidx, oidx) {
var quiz = quizzes[qidx];
var opts = document.querySelectorAll('#quiz-'+qidx+' .quiz-option');
opts.forEach(function(opt) {
opt.classList.remove('selected','correct','incorrect');
opt.style.pointerEvents = 'none';
});
opts[oidx].classList.add('selected');
var feedback = document.getElementById('quiz-feedback-'+qidx);
if(oidx === quiz.correct) {
opts[oidx].classList.add('correct');
feedback.className = 'quiz-feedback correct';
feedback.innerHTML = '<strong>‚úì ¬°Correcto!</strong> ' + quiz.explanation;
addPoints(10);
userStats.quizzesCompleted++;
checkAchievement(3);
} else {
opts[oidx].classList.add('incorrect');
opts[quiz.correct].classList.add('correct');
feedback.className = 'quiz-feedback incorrect';
feedback.innerHTML = '<strong>‚úó Incorrecto.</strong> La respuesta correcta es: <strong>'+quiz.opts[quiz.correct]+'</strong><br>' + quiz.explanation;
}
saveData();
}

// ============================================
// DRAG & DROP
// ============================================
function renderDragDrop() {
var html = '';
lipidsData.forEach(function(lipid, idx) {
html += '<div class="draggable" draggable="true" data-category="'+lipid.category+'" data-index="'+idx+'">'+lipid.name+'</div>';
});
document.getElementById('draggables-lipids').innerHTML = html;
setupDragDrop();
}

function setupDragDrop() {
var draggables = document.querySelectorAll('.draggable');
var dropZones = document.querySelectorAll('.drop-zone');
draggables.forEach(function(draggable) {
draggable.addEventListener('dragstart', function(e) {
e.dataTransfer.setData('text/plain', e.target.dataset.index);
e.target.classList.add('dragging');
});
draggable.addEventListener('dragend', function(e) {
e.target.classList.remove('dragging');
});
});
dropZones.forEach(function(zone) {
zone.addEventListener('dragover', function(e) {
e.preventDefault();
zone.classList.add('over');
});
zone.addEventListener('dragleave', function(e) {
zone.classList.remove('over');
});
zone.addEventListener('drop', function(e) {
e.preventDefault();
zone.classList.remove('over');
var idx = e.dataTransfer.getData('text/plain');
var draggable = document.querySelector('[data-index="'+idx+'"]');
var dropItems = zone.querySelector('.drop-items');
dropItems.appendChild(draggable);
});
});
}

function checkDragDrop() {
var correct = 0;
var total = lipidsData.length;
var draggables = document.querySelectorAll('.draggable');
draggables.forEach(function(drag) {
var parent = drag.parentElement.parentElement;
var expectedCat = drag.dataset.category;
var actualCat = parent.dataset.category;
if(expectedCat === actualCat) {
drag.classList.add('placed');
correct++;
} else {
drag.style.border = '2px solid #ef4444';
}
});
var points = correct * 10;
addPoints(points);
if(correct === total) {
unlockAchievement(4);
}
alert('¬°Completado! '+correct+'/'+total+' correctas. +'+points+' puntos');
}

function resetDragDrop() {
var draggables = document.querySelectorAll('.draggable');
var container = document.getElementById('draggables-lipids');
draggables.forEach(function(drag) {
drag.classList.remove('placed');
drag.style.border = '';
container.appendChild(drag);
});
}

// ============================================
// SIMULATOR
// ============================================
function startSimulation() {
if(simRunning) return;
simRunning = true;
unlockAchievement(5);
var canvas = document.getElementById('sim-canvas');
canvas.innerHTML = '';
simLipids = [];
for(var i=0; i<30; i++) {
var lipid = document.createElement('div');
lipid.className = 'molecule saturated';
lipid.style.left = Math.random()*90 + '%';
lipid.style.top = Math.random()*90 + '%';
canvas.appendChild(lipid);
simLipids.push(lipid);
}
simInterval = setInterval(updateSimulation, 100);
}

function updateSimulation() {
simLipids.forEach(function(lipid, idx) {
var x = parseFloat(lipid.style.left);
var y = parseFloat(lipid.style.top);
var centerY = 50;
if(y < centerY - 5 || y > centerY + 5) {
y += (centerY - y) * 0.1;
lipid.style.top = y + '%';
}
if(Math.abs(y - centerY) < 5) {
lipid.style.top = (idx < 15 ? 35 : 65) + '%';
}
});
document.getElementById('sim-stat-lipids').textContent = simLipids.length;
document.getElementById('sim-stat-bilayer').textContent = '85%';
}

function pauseSimulation() {
simRunning = false;
clearInterval(simInterval);
}

function resetSimulation() {
pauseSimulation();
document.getElementById('sim-canvas').innerHTML = '';
simLipids = [];
document.getElementById('sim-stat-lipids').textContent = '0';
document.getElementById('sim-stat-bilayer').textContent = '0%';
}

// ============================================
// CALCULATOR
// ============================================
function calculateIodine() {
var select = document.getElementById('calc-fatty-acid');
var value = select.value;
if(!value) {
document.getElementById('calc-result').style.display = 'none';
return;
}
document.getElementById('calc-result').style.display = 'block';
document.getElementById('calc-value').textContent = '√çndice de Yodo: ' + value;
var interpretation = '';
if(value == 0) interpretation = 'Completamente SATURADO. S√≥lido a temperatura ambiente.';
else if(value < 100) interpretation = 'MONOINSATURADO. L√≠quido a temperatura ambiente.';
else interpretation = 'POLIINSATURADO. Muy l√≠quido, requiere refrigeraci√≥n.';
document.getElementById('calc-interpretation').textContent = interpretation;
}

function calculateMeltingPoint() {
var chain = parseInt(document.getElementById('calc-chain-length').value);
var bonds = parseInt(document.getElementById('calc-double-bonds').value);
var config = document.getElementById('calc-config').value;
var baseMp = (chain - 10) * 5;
if(bonds > 0 && config === 'cis') baseMp -= bonds * 20;
else if(bonds > 0 && config === 'trans') baseMp -= bonds * 5;
document.getElementById('calc-mp-result').style.display = 'block';
document.getElementById('calc-mp-value').textContent = 'Punto de fusi√≥n estimado: ' + baseMp.toFixed(1) + '¬∞C';
var state = baseMp > 25 ? 'S√ìLIDO' : 'L√çQUIDO';
document.getElementById('calc-mp-interpretation').textContent = 'Estado a 25¬∞C: ' + state;
}

// ============================================
// FLASHCARDS
// ============================================
function renderFlashcards() {
var html = '';
flashcardsData.forEach(function(card, idx) {
html += '<div class="flashcard" onclick="this.classList.toggle(\'flipped\')">';
html += '<div style="font-size:2rem;margin-bottom:0.5rem">üß¨</div>';
html += '<div class="flashcard-front">'+card.front+'</div>';
html += '<div class="flashcard-back">'+card.back+'</div>';
html += '</div>';
});
document.getElementById('flashcard-container').innerHTML = html;
}

// ============================================
// EJERCICIOS ESCRITOS
// ============================================
function guardar(id, val) {
respuestas[id] = val;
saveData();
var el = document.getElementById('box-'+id);
if(el) {
if(val.trim().length > 10) {
el.classList.add('completed');
checkFirstQuestion();
checkQuestionMilestones();
} else {
el.classList.remove('completed');
}
}
actualizarProgreso();
document.getElementById('last-save').textContent = 'Guardado: ' + new Date().toLocaleTimeString();
}

function checkFirstQuestion() {
if(!userStats.achievements[1]) {
var completed = Object.keys(respuestas).filter(function(k) {
return respuestas[k].trim().length > 10;
}).length;
if(completed >= 1) unlockAchievement(1);
}
}

function checkQuestionMilestones() {
var completed = Object.keys(respuestas).filter(function(k) {
return respuestas[k].trim().length > 10;
}).length;
if(completed >= 10 && !userStats.achievements[2]) unlockAchievement(2);
}

function actualizarProgreso() {
var total = calcularTotal();
var comp = 0;
for(var k in respuestas) {
if(respuestas[k] && respuestas[k].trim().length > 10) comp++;
}
var pct = total > 0 ? Math.round(comp/total*100) : 0;
document.getElementById('progress-fill').style.width = pct + '%';
if(pct >= 50 && !userStats.achievements[6]) unlockAchievement(6);
if(pct >= 100 && !userStats.achievements[9]) unlockAchievement(9);
}

function calcularTotal() {
var t = preguntasData.pre.length + 3;
['sec31','sec32','sec33','sec34','sec35','sec36','sec37','sec38'].forEach(function(s){
t += preguntasData[s].dev.length + preguntasData[s].app.length;
});
return t;
}

function crearPregunta(id, txt, num) {
var val = respuestas[id] || '';
var comp = val.trim().length > 10 ? 'completed' : '';
return '<div class="question-item '+comp+'" id="box-'+id+'">'+
'<span class="question-text">'+num+'. '+txt+'</span>'+
'<textarea oninput="guardar(\''+id+'\',this.value)" placeholder="Escribe tu respuesta...">'+val+'</textarea></div>';
}

function renderPreguntas() {
var h = '<div class="card"><div class="card-header" style="background:#fefce8">3.0 Actividades Preliminares</div><div class="question-list">';
for(var i=0; i<preguntasData.pre.length; i++) h += crearPregunta('pre-'+i, preguntasData.pre[i], i+1);
h += '</div></div>';
var secs = ['sec31','sec32','sec33','sec34','sec35','sec36','sec37','sec38'];
var cols = ['#eff6ff','#f0fdf4','#fffbeb','#eef2ff','#faf5ff','#ecfdf5','#fef2f2','#fff7ed'];
var noms = ['3.1 Introducci√≥n','3.2 √Åcidos Grasos','3.3 TAGs y Ceras','3.4 Fosfol√≠pidos','3.5 Esfingol√≠pidos','3.6 Isoprenoides','3.7 Eicosanoides','3.8 Digesti√≥n'];
for(var s=0; s<secs.length; s++) {
var sec = preguntasData[secs[s]];
h += '<div class="card"><div class="card-header" style="background:'+cols[s]+'">'+noms[s]+'</div><div class="question-list">';
h += '<div style="margin-bottom:1rem"><div style="font-weight:700;color:#6b7280;margin-bottom:0.5rem;font-size:0.875rem">DESARROLLO</div>';
for(var i=0; i<sec.dev.length; i++) h += crearPregunta(secs[s]+'-d-'+i, sec.dev[i], i+1);
h += '</div><div style="border-top:1px solid #e5e7eb;padding-top:1rem"><div style="font-weight:700;color:#6b7280;margin-bottom:0.5rem;font-size:0.875rem">APLICACI√ìN</div>';
for(var i=0; i<sec.app.length; i++) h += crearPregunta(secs[s]+'-a-'+i, sec.app[i], i+1);
h += '</div></div></div>';
}
h += '<div class="card integradora"><div class="card-header integradora-header">‚òÖ Actividad Integradora</div><div class="question-list">';
h += '<div class="alert alert-warning"><strong>Caso Cl√≠nico:</strong> Paciente 45 a√±os, riesgo cardiovascular, LDL elevado, HDL bajo.</div>';
h += crearPregunta('int-1','An√°lisis: L√≠pidos en dieta y efecto en LDL',1);
h += crearPregunta('int-2','Metabolismo: Funci√≥n LDL/HDL y mecanismo estatinas',2);
h += crearPregunta('int-3','Recomendaciones: Beneficio omega-3',3);
h += '</div></div>';
document.getElementById('preguntas-container').innerHTML = h;
}

// ============================================
// GAMIFICACI√ìN
// ============================================
function addPoints(pts) {
userStats.points += pts;
updateStats();
saveData();
}

function unlockAchievement(id) {
if(userStats.achievements[id]) return;
userStats.achievements[id] = true;
userStats.badges++;
var ach = achievements[id];
addPoints(ach.points);
document.getElementById('ach-'+id).classList.add('unlocked');
showAchievementModal(id);
updateStats();
saveData();
}

function checkAchievement(id) {
if(!userStats.achievements[id]) unlockAchievement(id);
}

function showAchievementModal(id) {
var ach = achievements[id];
document.getElementById('modal-badge').textContent = ach.icon;
document.getElementById('modal-title').textContent = ach.title;
document.getElementById('modal-description').textContent = ach.desc;
document.getElementById('modal-points').textContent = ach.points;
document.getElementById('achievement-modal').classList.add('show');
}

function closeAchievementModal() {
document.getElementById('achievement-modal').classList.remove('show');
}

function updateStats() {
document.getElementById('stat-points').textContent = userStats.points;
document.getElementById('stat-badges').textContent = userStats.badges + '/10';
}

function exportar() {
var md = '# Biof√≠sica UACH - L√≠pidos y Membranas\n\n**Puntos:** '+userStats.points+'\n**Logros:** '+userStats.badges+'/10\n\n';
for(var k in respuestas) {
if(respuestas[k]) md += '## '+k+'\n'+respuestas[k]+'\n\n';
}
var blob = new Blob([md], {type:'text/markdown'});
var a = document.createElement('a');
a.href = URL.createObjectURL(blob);
a.download = 'biofisica_respuestas.md';
a.click();
}

// ============================================
// AUTO-INICIO
// ============================================
if(document.readyState === 'loading') {
document.addEventListener('DOMContentLoaded', init);
} else {
init();
}
</script>
</body>
</html>
